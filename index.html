<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <input type="file" id="myfile" name="myfile">
  <table id="example" class="display" width="100%"></table>
</body>

</html>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.0/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.0/shim.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
<script src="./main.js"></script>
<script>
  let dataset;
  const toJson = new xlsToJson();
  const _ = document;
  const fileUpload = _.getElementById('myfile');
  fileUpload.onchange = () => {
    var res = toJson.convertoJson(event);
    res.then((json) => {
      splitData(json);  
    })
  };

  function splitData(json) {
    var array = Object.keys(json)
    var checkpoint = 0;
    array.forEach(sheet => {
      if (checkpoint === 0) {
        addSignDatatoTable(json[sheet])
        checkpoint++;
      }
    });
  }

  function addSignDatatoTable(table) {
    dataset = table.filter((d) => typeof (d[0]) === "number");
    console.log(dataset);
    $('#example').DataTable({
      data: dataset,
      columns: [
        { title: "ลำดับ" },
        { title: "รหัส" },
        { title: "ชื่อ" },
        { title: "สกุล" },
        { title: "5" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
        { title: "6" },
      ]
    });
  }
</script>